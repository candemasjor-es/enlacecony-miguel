{% extends 'base_videos.html.twig' %}

{% block title %}Enlace cony i miguel - perfil
{% endblock %}

{% block body %}
<style>
    #myVideo {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 100%;
        height: auto;
        min-width: 100%;
        min-height: 100%;
    }
</style>

<div id="aviso-orientacion-vertical" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; font-size: 24px;">
    Por favor, toque la pantalla para continuar.
</div>
<video id="myVideo" muted playsinline>
    <source src="{{ asset('build/videos/fondo.mp4') }}" type="video/mp4">
    Su navegador no es compatible con video HTML5.
</video>

<script>
    const avisoOrientacionVertical = document.getElementById('aviso-orientacion-vertical');
    const myVideo = document.getElementById('myVideo');
    let isTouched = false;

    function isMobile() {
        return /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    }

    function handleOrientationChange() {
        if ((isMobile() && window.innerWidth > window.innerHeight) || (isTouched && window.innerWidth < window.innerHeight)) {
            avisoOrientacionVertical.style.display = 'flex';
            myVideo.pause();
        } else if (isTouched) {
            avisoOrientacionVertical.style.display = 'none';
            myVideo.play();

            setTimeout(() => {
                myVideo.pause();
                // Redirige a la ruta especificada
                window.location.href = '{{ path('app_home') }}'; // Asegúrate de que '{{ path('app_home') }}' se evalúe correctamente en tu entorno
            }, 44000); // 44 segundos en milisegundos
        }
    }

    function handleTouch() {
        isTouched = true;
        avisoOrientacionVertical.innerHTML = 'Toque nuevamente para continuar.';
        avisoOrientacionVertical.appendChild(document.createElement('br'));
        avisoOrientacionVertical.innerHTML += 'O espere, será redirigido automáticamente.';
        
        setTimeout(() => {
            // Redirige a la ruta especificada
            window.location.href = '{{ path('app_home') }}'; // Asegúrate de que '{{ path('app_home') }}' se evalúe correctamente en tu entorno
        }, 44000); // 44 segundos en milisegundos

        handleOrientationChange();
    }

    window.addEventListener('touchstart', handleTouch);
    window.addEventListener('click', handleTouch);
    window.addEventListener('orientationchange', handleOrientationChange);
    handleOrientationChange(); // Llama a la función al cargar la página para verificar la orientación inicial
</script>


{% endblock %}
